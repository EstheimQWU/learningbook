# Linux提权
## 文件特殊权限
### 隐藏权限与chattr

隐藏权限：SUID（4）、SGID（2）、SBIT（1）

+ 即使不是文件所有者也可以暂时拥有文件所有者的权利。
+ 拥有这个属性的目录内创建的东西，所属组都属于这个目录的所属组，与东西的创建者无关。
+ 在拥有这个属性的目录内创建的东西，除了root和创建者本身，谁都不能删。
+ 四位数的文件权限，第一位为隐藏权限。

chattr命令用于设置文件的隐藏属性，格式为`chattr [variable] filename`

**模式**
``
a：让文件或目录仅供附加用途。
b：不更新文件或目录的最后存取时间。
c：将文件或目录压缩后存放。
d：将文件或目录排除在倾倒操作之外。
i：不得任意更动文件或目录。
s：保密性删除文件或目录。
S：即时更新文件或目录。
u：预防意外删除。
``
**参数**
```
-R 递归处理，将指定目录下的所有文件及子目录一并处理。
-v<版本编号> 设置文件或目录版本。
-V 显示指令执行过程。
+<属性> 开启文件或目录的该项属性。
-<属性> 关闭文件或目录的该项属性。
=<属性> 指定文件或目录的该项属性。
```

### SUID 令执行者临时拥有属主的权限
给文件设置SUID  
1、只有可执行的二进制程序文件才能设定SUID权限，其他程序设置SUID没有意义。  
2、施展命令者需要对该程序拥有1（excute）权限。  
3、施展命令者在执行该程序时获得该程序文件属主的身份。  
4、SUID只在执行中有效，其他时候无效。  

使用`chmod 4??? filename`或者`chmod u+s filename`去赋予SUID权限
使用`chmod ??? filename`或者`chmod u-s filename`取消SUID

```
-rwsr-xr-x 表示SUID和所有者权限中可执行位被设置

-rwSr--r-- 表示SUID被设置，但所有者权限中可执行位没有被设置

-rwxr-sr-x 表示SGID和同组用户权限中可执行位被设置

-rw-r-Sr-- 表示SGID被设置，但同组用户权限中可执行位没有被设置
```

### SGID
使用`chmod 4??? filename`或者`chmod u+s filename`去赋予SUID权限
使用`chmod ??? filename`或者`chmod u-s filename`取消SUID

### SBIT
仅对目录有效，只可管理自己的数据而不能移动或者删除他人的文件。

在这个目录中，用户可以修改自己的文件，但是不能够移动或者删除别人的文件。

## su与sudo
### su
su命令可用于变更使用者的身份（切换登陆者），格式为`su [-] username`。

其中`-`用于变更环境变量。

exit可用于退出当前用户。

### sudo
+ 限制用户执行指令的命令
+ 记录用户执行的每一条命令
+ 配置文件（/etc/sudoers）提供集中的管理用户、权限与主机等参数。
+ 验证过密码后5分钟（默认值）内无需再让用户验证密码，更加方便。

通过visudo命令编辑sudo程序的配置文件来改变参数情况。

### 文件访问控制列表
通过setfacl命令增加或者修改ACL规则，可以达到设置指定的用户或者用户组对某个文件的操作权限。

**参数**
-R    递归
-m    设置文件的acl规则
-b    删除acl规则

`getfacl`命令可用于显示文件的ACL规则，格式为`getfacl filename`